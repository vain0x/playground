# 生存解析

ローカルの定義箇所と使用箇所を探す

## モチベーション

生存解析のモチベーションは、ローカルが生存しているかどうかの判断を容易にすること

ローカルの出現箇所においてローカルが生存しているかどうかの判断は明確ではない。
原因は、ターミネータを経由して別のブロックでローカルが使用される可能性があって、ブロック内をみるだけでは判断がつかないため。
CFG (制御フローグラフ) は閉路を含むので生存解析は不動点計算を要する

生存解析の結果は不要コード除去 (ローカルへの不要な代入の除去、使用しないローカルの除去) やレジスタ割り当て (生存期間が重複しないローカルを単一のレジスタに割り当てること) など。

## 入出力

入力されるIRに課される条件は特にない

出力は各ローカルの出現が生存しているかどうかのマップ

## 定義・使用・生存

- ローカルに代入する部分のことをローカルの **定義箇所** という
- ローカルから値を読む部分のことをローカルの **使用箇所** という
- 定義箇所より後、最後の使用箇所まで、ローカルは **生存** している

## 関数のパラメータと返り値

- 関数のパラメータであるローカルは最初の基本ブロックの先頭で定義される
- 関数の返り値であるローカルはreturnターミネータによって使用される

## 使用の伝播

ローカルを使用するかどうかはターミネーターを介して推移的に伝播する。
すなわちジャンプ先がローカルを使用するならターミネータもローカルを使用するとみなす。
(ジャンプ先自身が定義したローカルを使用するのは除く)

ブロックがローカルを使用するかどうかを考える。
ブロック自身で定義していないローカルの使用箇所に到達するなら、ブロックはローカルを使用するとみなす。
(そのローカルはブロックの自由変数のようなもの)

## 参考

- 虎本 (最新コンパイラ構成技法) の生存解析の部分
